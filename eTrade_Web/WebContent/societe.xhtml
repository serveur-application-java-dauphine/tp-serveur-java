<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
>  
      
<h:head>
	<title>eTrade - <h:outputText value="#{societeManagedBean.getSociete(param.s).name}" /> </title>

</h:head> 
<body> 
	<a href="/eTrade_Web/Logout" style="float:right">Se déconnecter</a>
	<h:outputLabel value="Bonjour, #{sessionUserManagedBean.utilisateur.firstname} &nbsp; &nbsp;" style="float:right"/>
	<br/><br/>

	<h:form>
  	  <h:dataTable value="#{societeManagedBean.getSociete(param.s).actualites}" var="actu">
	  	  	<f:facet name="header">Actualités de la société #{societeManagedBean.getSociete(param.s).name} :</f:facet>
	  	  	<!-- TODO ce rendu ne fonctionne pas. -->
	  	  	<h:outputText rendered="#{empty societeManagedBean.getSociete(param.s).actualites}" >Il n'y a pas d'actualité à afficher pour cette entreprise.</h:outputText>
	  	  	<h:column>
		  	  	<h:link value="#{actu.titre}" outcome="actualite">
		  	  		<f:param name="a" value="#{actu.idActualite}"/>
		  	  	</h:link>
	  	  	</h:column>
	  	  	<span style="font-size: 11px;">
		  	  	<h:column>
		  	  		<h:outputText value="créé le #{actu.date_creation}" />
		  	  	</h:column>
		  	  	<h:column>
		  	  		<h:outputText rendered="#{not empty actu.date_modification}" value="modifié le #{actu.date_modification}" />
  	  			</h:column>
  	  		</span>
	  	  	<h:column>
	  	  		<!-- TODO à améliorer -->
	  	  		<!-- TODO A voir pour passer dans actualite.xhtml -->
	  	  		<!-- Si la société est celle de l'utilisateur et que l'article a été créé par ce même utilisateur, il peut le supprimer -->
	  	  		<h:panelGroup rendered="#{sessionUserManagedBean.utilisateur.societe.idSociete eq param.s and actu.utilisateur.idUtilisateur eq sessionUserManagedBean.utilisateur.idUtilisateur}">
	  	  			<h:link action="#{actualiteManagedBean.deleteActualite()}" value="Supprimer votre actualité" outcome="societe">
	  	  				<f:param name="s" value="#{param.s}"></f:param>
	  	  			</h:link> 
	  	  		</h:panelGroup>
	  	  	</h:column>
  	  </h:dataTable>
   	   <br/>
   	   <!-- On ne peut créer une actualité pour la société s que si l'utilisateur est associé à s -->
	   <h:link rendered="#{sessionUserManagedBean.utilisateur.societe.idSociete eq param.s}" value="Créer une nouvelle actualité." outcome="actualite-creer"></h:link>
	   
	</h:form>
</body> 
</html>				
